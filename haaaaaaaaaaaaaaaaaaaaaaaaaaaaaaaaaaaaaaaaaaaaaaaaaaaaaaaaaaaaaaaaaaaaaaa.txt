import mysql.connector
import json

class DBConnection:
    con = None

    @staticmethod
    def get_connection():
        if DBConnection.con is None:
            con_path = "../configs/database_config.json"
            con_string = PropertyUtil.get_property_string(con_path)
            try:
                DBConnection.con = mysql.connector.connect(**con_string)
                return DBConnection.con
            except Exception as e:
                raise DatabaseConnectionException("Error connecting to the database.") from e
        else:
            return DBConnection.con
class PropertyUtil:
    @staticmethod
    def get_property_string(file_name):
        try:
            with open(file_name) as f:
                json_f = json.load(f)
                return json_f
        except Exception as e:
            print(f"Error while opening files: {e}.")
